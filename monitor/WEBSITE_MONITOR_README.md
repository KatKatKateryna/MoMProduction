# Website Monitor

This directory contains a website monitoring script to check if websites are up and running. The script now includes email notification functionality using Gmail SMTP.

## Files

- `website_monitor.py` - Main monitoring script with email notifications
- `website_monitor_config.cfg` - Configuration file for websites and settings
- `monitor_config.cfg` - Configuration file for email settings (shared with main monitor)

## Usage

### Basic Usage

Run the script to check all configured websites and send email notifications:

```bash
python website_monitor.py
```

### Configuration

#### Website Configuration

Edit `website_monitor_config.cfg` to add more websites to monitor:

```ini
[WEBSITES]
eht_scigap = https://eht.scigap.org
example_site = https://example.com
google = https://google.com

[SETTINGS]
timeout = 10
retry_attempts = 3
retry_delay = 5
log_file = website_monitor.log
```

#### Email Configuration

The script uses the Gmail configuration from `monitor_config.cfg` for email notifications:

```ini
[GMAIL]
from_email = your_email@gmail.com
to_emails = recipient1@example.com,recipient2@example.com
server = smtp.gmail.com
port = 465
password = your_app_password
```

**Note:** Use an App Password for Gmail, not your regular password. See [Gmail App Passwords](https://support.google.com/accounts/answer/185833) for setup instructions.

### Features

- **Multiple Website Support**: Monitor multiple websites from a single config file
- **Email Notifications**: Automatic email alerts with monitoring results
- **Smart Subject Lines**: Warning in subject when sites are down
- **Retry Logic**: Configurable retry attempts with delays for failed requests
- **Response Time Tracking**: Measures and reports response times
- **Logging**: Logs results to a file for historical tracking
- **Exit Codes**: Returns non-zero exit code if any site is down (useful for automation)
- **Detailed Output**: Shows status, response time, status codes, and error messages

### Email Notifications

The script automatically sends email notifications with:

- **Success Subject**: "✅ Website Monitor Report - All sites up"
- **Warning Subject**: "⚠️ WARNING: Website Monitor Alert - X site(s) down"
- **Detailed Report**: Summary statistics and detailed status of each website
- **Timestamps**: When each check was performed
- **Error Details**: Specific error messages for failed sites

### Integration with Cron

You can add this to your crontab to monitor websites regularly:

```bash
# Check websites every 5 minutes
*/5 * * * * cd /path/to/monitor && python website_monitor.py >> monitor.log 2>&1

# Check websites hourly
0 * * * * cd /path/to/monitor && python website_monitor.py
```

### Sample Output

```
Checking 1 website(s)...
--------------------------------------------------------------------------------
Checking eht_scigap: https://eht.scigap.org
✅ eht_scigap: UP
   Response time: 0.05s
   Status code: 200
   Timestamp: 2025-09-15 14:50:40

Website Monitor Summary
======================
Total websites: 1
Up: 1
Down: 0
Success rate: 100.0%
Checked at: 2025-09-15 14:50:40

Email notification sent to: recipient@example.com
All websites are up!
```

### Email Sample

**Subject:** ✅ Website Monitor Report - All sites up

**Body:**
```
Website Monitoring Report
========================

Summary:
- Total websites monitored: 1
- Sites UP: 1
- Sites DOWN: 0
- Success rate: 100.0%
- Report generated: 2025-09-15 14:50:40

Detailed Results:

✅ eht_scigap: UP
   URL: https://eht.scigap.org
   Timestamp: 2025-09-15 14:50:40
   Response time: 0.05s
   Status code: 200

---
Generated by Website Monitor
Configuration: website_monitor_config.cfg
```

### Error Handling

The script handles various types of errors:
- **Connection Errors**: Network connectivity issues
- **Timeouts**: Requests that take too long
- **HTTP Errors**: Non-200 status codes
- **DNS Errors**: Invalid or unreachable domains
- **Email Errors**: SMTP connection or authentication failures

Each error is logged with details for troubleshooting, and email notifications include specific error information.